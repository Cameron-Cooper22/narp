create an integration test that opens up ports on self, and then read them
